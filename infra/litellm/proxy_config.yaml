# =============================================================================
# CODEXFLOW.DEV - LiteLLM Proxy Configuration
# Version: 2.1 (Stateless Mode)
# =============================================================================
#
# IMPORTANT: LiteLLM runs in STATELESS mode (no database).
# All user management, quota tracking, and usage logging is handled by Laravel.
# LiteLLM is just a smart proxy that routes requests to the right LLM provider.
#
# ALIAS STRATEGY:
# - cf-fast    → Claude Haiku 3.5 (3 org key pool) - Quick tasks
# - cf-deep    → Claude Sonnet 4 (3 org key pool) - Complex logic
# - cf-planner → GPT-4o-mini - Plan/chunk JSON only
# - cf-grace   → Llama 3.1 405B FREE (OpenRouter) - Quota exhausted fallback
# - cf-grace-fallback → GPT-4o-mini - If Llama fails
#
# =============================================================================

model_list:
  # =========================
  # FAST POOL (Claude Haiku 3.5) x3 org keys
  # Purpose: Quick, simple coding tasks
  # Cost: $0.80/1M input, $4.00/1M output
  # =========================
  - model_name: cf-fast
    litellm_params:
      model: anthropic/claude-3-5-haiku-latest
      api_key: os.environ/ANTHROPIC_KEY_ORG_A
      timeout: 60

  - model_name: cf-fast
    litellm_params:
      model: anthropic/claude-3-5-haiku-latest
      api_key: os.environ/ANTHROPIC_KEY_ORG_B
      timeout: 60

  - model_name: cf-fast
    litellm_params:
      model: anthropic/claude-3-5-haiku-latest
      api_key: os.environ/ANTHROPIC_KEY_ORG_C
      timeout: 60

  # =========================
  # DEEP POOL (Claude Sonnet 4) x3 org keys
  # Purpose: Complex logic, architecture decisions
  # Cost: $3.00/1M input, $15.00/1M output
  # =========================
  - model_name: cf-deep
    litellm_params:
      model: anthropic/claude-sonnet-4-20250514
      api_key: os.environ/ANTHROPIC_KEY_ORG_A
      timeout: 120

  - model_name: cf-deep
    litellm_params:
      model: anthropic/claude-sonnet-4-20250514
      api_key: os.environ/ANTHROPIC_KEY_ORG_B
      timeout: 120

  - model_name: cf-deep
    litellm_params:
      model: anthropic/claude-sonnet-4-20250514
      api_key: os.environ/ANTHROPIC_KEY_ORG_C
      timeout: 120

  # =========================
  # DEEP FALLBACK (Claude Sonnet 3.5) x3 org keys
  # Purpose: Fallback when Sonnet 4 fails
  # =========================
  - model_name: cf-deep-fallback
    litellm_params:
      model: anthropic/claude-3-5-sonnet-latest
      api_key: os.environ/ANTHROPIC_KEY_ORG_A
      timeout: 120
      rpm: 60
      tpm: 30000

  - model_name: cf-deep-fallback
    litellm_params:
      model: anthropic/claude-3-5-sonnet-latest
      api_key: os.environ/ANTHROPIC_KEY_ORG_B
      timeout: 120
      rpm: 60
      tpm: 30000

  - model_name: cf-deep-fallback
    litellm_params:
      model: anthropic/claude-3-5-sonnet-latest
      api_key: os.environ/ANTHROPIC_KEY_ORG_C
      timeout: 120
      rpm: 60
      tpm: 30000

  # =========================
  # PLANNER (GPT-4o-mini via OpenRouter)
  # Purpose: Decompose pipeline - JSON plan generation
  # Cost: $0.15/1M input, $0.60/1M output
  # =========================
  - model_name: cf-planner
    litellm_params:
      model: openrouter/openai/gpt-4o-mini
      api_key: os.environ/OPENROUTER_API_KEY
      timeout: 30
      rpm: 500
      tpm: 100000
      max_tokens: 500

  # =========================
  # GRACE LANE PRIMARY (Llama 3.1 405B FREE via OpenRouter)
  # Purpose: When user quota exhausted - FREE fallback!
  # Cost: $0 (FREE!)
  # =========================
  - model_name: cf-grace
    litellm_params:
      model: openrouter/meta-llama/llama-3.1-405b-instruct:free
      api_key: os.environ/OPENROUTER_API_KEY
      timeout: 90
      rpm: 20
      tpm: 100000

  # =========================
  # GRACE LANE FALLBACK (GPT-4o-mini via OpenRouter)
  # Purpose: If Llama fails, use this
  # Cost: $0.15/1M input, $0.60/1M output
  # =========================
  - model_name: cf-grace-fallback
    litellm_params:
      model: openrouter/openai/gpt-4o-mini
      api_key: os.environ/OPENROUTER_API_KEY
      timeout: 60
      rpm: 500
      tpm: 200000

  # =========================
  # AGENT TIER (Grok 4.1 Fast via OpenRouter)
  # Purpose: Agent/Tool calling operations - Best agentic model!
  # Context: 2,000,000 tokens (2M!)
  # Cost: ~$3/1M input, ~$15/1M output
  # =========================
  - model_name: cf-agent
    litellm_params:
      model: openrouter/x-ai/grok-3-beta
      api_key: os.environ/OPENROUTER_API_KEY
      timeout: 180
      rpm: 60
      tpm: 500000
      max_tokens: 4000

# =============================================================================
# ROUTER SETTINGS
# =============================================================================
router_settings:
  # Routing strategy: usage-based for better load distribution
  routing_strategy: usage-based-routing
  
  # Retry settings
  num_retries: 2
  timeout: 140
  
  # Cooldown for failing deployments
  allowed_fails: 3
  cooldown_time: 60

# =============================================================================
# LITELLM SETTINGS
# =============================================================================
litellm_settings:
  # Global retry and timeout
  num_retries: 2
  request_timeout: 140
  
  # Fallback chains
  fallbacks:
    - cf-deep: [cf-deep-fallback]
    - cf-grace: [cf-grace-fallback]
  
  # Drop params that provider doesn't support
  drop_params: true

# =============================================================================
# GENERAL SETTINGS (Stateless Mode)
# =============================================================================
general_settings:
  # Master key for proxy authentication
  master_key: os.environ/LITELLM_MASTER_KEY
  
  # STATELESS MODE - No database required
  # Laravel handles all user/quota management
  store_model_in_db: false
  disable_spend_logs: true

# =============================================================================
# ENVIRONMENT VARIABLES REQUIRED:
# =============================================================================
# ANTHROPIC_KEY_ORG_A     - Anthropic API key (org A)
# ANTHROPIC_KEY_ORG_B     - Anthropic API key (org B)  
# ANTHROPIC_KEY_ORG_C     - Anthropic API key (org C)
# OPENROUTER_API_KEY      - OpenRouter key (Llama FREE + GPT-4o-mini)
# LITELLM_MASTER_KEY      - Master key for proxy auth
# =============================================================================
